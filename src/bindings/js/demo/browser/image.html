<html>
  <head>
    <title>OpenVINO JS</title>
    <link rel="stylesheet" href="./styles.css">
  </head>
  <body>
    <div class="content">
      <p id="status">Loading OpenVINO package...</p>

      <div id="panel">
        <label class="file-selector">
          Select Image
          <input type="file" id="select-btn" accept="image/*" />
        </label>
        <div id="container" class="row"></div>
      </div>
    </div>
    <!-- <script src="./openvino_wasm.js"></script>
    <script src="./script.js"></script> -->
    <script>
      const selectBtn = document.getElementById('select-btn');
      const containerElement = document.getElementById('container');

      const WIDTH = 224;
      const HEIGHT = 224;

      selectBtn.addEventListener('change', );

      async function fileSelectorHandler(e) {
        containerElement.innerHTML = '';

        const selectedFile = e.srcElement.files[0];
        
        const fileData = await imgWasSelected(selectedFile);
        const img = new Image();
        const canvas = createCanvas(WIDTH, HEIGHT);
        const ctx = canvas.getContext('2d');

        img.src = fileData;
        img.addEventListener('load', () => {
          containerElement.appendChild(img);
          containerElement.appendChild(canvas);

          ctx.drawImage(img, 0, 0, WIDTH, HEIGHT);
        });
      }

      function imgWasSelected(file) {
        const fr = new FileReader();

        fr.readAsDataURL(file);

        return new Promise((resolve, reject) => {
          fr.addEventListener('load', () => {
            resolve(fr.result);
          });

          fr.addEventListener('error', () => {
            reject(new Error('Error on loading file'));
          });
        });
      }

      function createCanvas(width, height) {
        const canvasElement = document.createElement('canvas');

        canvasElement.width = width;
        canvasElement.height = height;

        return canvasElement;
      }
    </script>
  </body>
</html>
